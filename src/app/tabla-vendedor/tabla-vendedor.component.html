
<mat-sidenav-container>
    <mat-sidenav [(opened)]="opened" position="end" mode="over" [fixedInViewport]="true" >
        <button mat-icon-button class="btn-close" (click)="opened = !opened"> <mat-icon>close</mat-icon></button>        
        <h2 class="titulo-form">Crear Vendedor</h2>
        <div class="row">
            <div class="col-4">
              <div class="list-group" id="list-tab" role="tablist">
                <a class="list-group-item fondo-rojo list-group-item-action active" id="list-home-list" data-toggle="list" href="#list-home" role="tab" aria-controls="home">Datos Generales</a>
                <a class="list-group-item fondo-rojo list-group-item-action" id="list-profile-list" data-toggle="list" href="#list-profile" role="tab" aria-controls="profile">Usuario y Contraseña</a>
                <a class="list-group-item fondo-rojo list-group-item-action" id="list-messages-list" data-toggle="list" href="#list-messages" role="tab" aria-controls="messages">Asignar Cliente</a>
              </div>
            </div>
            <div class="col-8">
              <div class="tab-content" id="nav-tabContent">
                  <!-- Datos Generales -->
                <div class="tab-pane fade show active" id="list-home" role="tabpanel" aria-labelledby="list-home-list">
                    
                        <div class="form-group">
                            <label class="texto-rojo" for="nombres">Nombres</label>
                            <input type="form-control" id="nombres" name="nombre" [(ngModel)]="dataVendedor.name" placeholder="Nombres" type="text">
                        </div>
                        <div class="form-group">
                            <label class="texto-rojo" for="apellido">Apellido</label>
                            <input type="form-control" id="apellido" name="apellido" [(ngModel)]="dataVendedor.apellidos" placeholder="Apellido" type="text">
                        </div>
                        <div class="form-group">
                            <mat-form-field appearence="fill">
                                <mat-label class="texto-rojo">Tipo de documento</mat-label>
                                <mat-select>
                                    <mat-option value="">None</mat-option>
                                    <mat-option value="Cedula de ciudadania">Cedula de ciudadania</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </div>
                        <div class="form-group">
                            <label for="numeroDocumento">Número de documento</label>
                            <input type="number" name="numeroDocumento" id="numeroDocumento" [(ngModel)]="dataVendedor.dni" placeholder="Número de documento" class="form-control">
                        </div>
                        <div class="form-group">
                            <label for="telefono" class="texto-rojo">Celular</label>
                            <!-- <input type="text" *ngIf="dataVendedor.userdata.telefono === ''; else phoneValueKey" name="telefono" [(ngModel)]="dataVendedor.userdata.telefono" id="telefono" placeholder="Celular" class="form-control">
                            <ng-template #phoneValueKey>
                                <input type="text" name="telefono" [(ngModel)]="dataVendedor['userdata'][0].value_key" id="telefono" placeholder="Celular" class="form-control">
                            </ng-template> -->
                            
                        </div>
                        <div class="form-group">
                            <label for="codigo" class="texto-rojo text-capitalize">Codigo vendedor</label>
                            <!-- <input type="number" name="codigo" *ngIf="dataVendedor.userdata.codigo === 0; else codigoValueKey" [(ngModel)]="dataVendedor.userdata.codigo" id="codigo" placeholder="Codigo Vendedor" class="form-control">
                            <ng-template #codigoValueKey>
                                <input type="number" name="codigo" [(ngModel)]="dataVendedor['userdata'][1].value_key" id="codigo" placeholder="Codigo Vendedor" class="form-control">
                            </ng-template> -->
                            
                    </div>
                </div>
                <!-- Usuario y contraseña -->
                <div class="tab-pane fade" id="list-profile" role="tabpanel" aria-labelledby="list-profile-list">
                    <div class="form-group">
                        <label for="email" class="texto-rojo">Correo Electronico</label>
                        <input type="email" name="email" [(ngModel)]="dataVendedor.email" class="form-control" id="email" pattern="" placeholder="example@email.com">
                    </div>
                    <div class="form-group">
                        <label for="password" class="texto-rojo">Contraseña</label>
                        <input type="password" name="password" [(ngModel)]="dataVendedor.password" class="form-control" id="password" placeholder="Contraseña">
                    </div>
                    <div class="form-group">
                        <label for="password" class="texto-rojo">Confirmar Contraseña</label>
                        <input type="password" class="form-control" name="confirm_password" [(ngModel)]="dataVendedor.confirm_password" id="password" placeholder="Confirmar Contraseña">
                    </div>
                </div>
                <!-- Asignar Cliente -->
                <div class="tab-pane fade" id="list-messages" role="tabpanel" aria-labelledby="list-messages-list">
                    <form >
                    <mat-form-field class="buscarCliente" appearance="fill">
                        <mat-label>Asignar Cliente</mat-label>
                        <input placeholder="Asignar Cliente" matInput [formControl]="asignarCliente" [matAutocomplete]="auto">
                        <mat-icon matSuffix>search</mat-icon>
                        <mat-autocomplete #auto="matAutocomplete">
                            <mat-option *ngFor="let cliente of filteredOptions | async" [value]="cliente">
                              {{cliente}}
                            </mat-option>
                          </mat-autocomplete>                 
                    </mat-form-field>
                    <div class="form-group">
                        <div class="form-group">
                            <div class="box-create-new">
                                <div class="box-mas">
                                    <img class="mas" src="./assets/img/mas.svg" alt="">
                                </div>
                            <a (click)="crearVendedor()" *ngIf="dataVendedor.email.length <= 0" class="btn-nuevo-cliente">Nuevo Vendedor</a>
                            <a (click)="actualizarVendedor()" *ngIf="dataVendedor.email.length > 0" class="btn-nuevo-cliente">Actuializar Vendedor</a>
                            <a (click)="opened = !opened" class="cancelar ml-3">Cancelar</a>
                        </div>
                    </div>
                    </div>
                </form>
                </div>
              </div>
            </div>
          </div>
        
    </mat-sidenav>
    <mat-sidenav-content>
    <div class="filtros">   
    <div (click)="accionesVendedor()" class="box-editar">
        <span class="texto-editar">Acción de</span>
        <div class="icono-puntos">
            <img src="./assets/img/edit_points.svg" alt="">
        </div>
        <ul class="acciones-vendedor">
            <li (click)="cargarDatos()">
                <img src="./assets/img/editar.svg" alt=""> Editar
            </li>
            <li><a (click)="exporter.exportTable('xlsx', {fileName:'vendedores'})"><img src="./assets/img/icons-filter/export.svg" alt=""> Exportar</a></li>
            <li (click)="eliminarVendedor()"><img src="./assets/img/icons-filter/trash.svg" alt=""> Eliminar</li>
        </ul>
    </div>
        <div class="box-create-new">
            <div class="box-mas">
                <img class="mas" src="./assets/img/mas.svg" alt="">
            </div>
        <button class="btn-nuevo-cliente" (click)="nuevoVendedor()">Nuevo Vendedor</button>
        </div>
    </div>
    <mat-form-field class="input-busqueda">
        <mat-label>Buscar</mat-label>
        <input matInput (keyup)="filtro($event)" #input>
        <mat-icon matSuffix>search</mat-icon>
    </mat-form-field>
    <table mat-table [dataSource]="dataSource" matTableExporter  #exporter="matTableExporter">
        <ng-container matColumnDef="select">
            <th mat-header-cell *matHeaderCellDef>
                <mat-checkbox (change)="$event ? masterToggle() : null"
                    [checked]="selection.hasValue() && isAllSelected()"
                    [indeterminate]="selection.hasValue() && !isAllSelected()"
                    [aria-label]="checkboxLabel()">
                </mat-checkbox>
            </th>
            <td mat-cell *matCellDef="let user; let i = index">
                <mat-checkbox (click)="$event.stopPropagation()"
                    (click)="editarVendedor(user, i)"
                    (change)="$event ? selection.toggle(user) : null"
                    [checked]="selection.isSelected(user)"
                    [aria-label]="checkboxLabel(user)">
                </mat-checkbox>
            </td>
        </ng-container>
        <ng-container matColumnDef="Nombre">
            <th mat-header-cell *matHeaderCellDef>Nombre</th>
            <td mat-cell *matCellDef="let user">
                <div class="iniciales">{{ user.iniciales }}</div>
                <p class="nombre">{{ user.name }} {{ user.apellidos }}</p>
            </td>
        </ng-container>
        <ng-container matColumnDef="Email">
            <th mat-header-cell *matHeaderCellDef>Email</th>
            <td mat-cell *matCellDef="let user">{{ user.email }}</td>
        </ng-container>
        <ng-container matColumnDef="Telefono">
            <th mat-header-cell *matHeaderCellDef>Teléfono</th>
            <td mat-cell *matCellDef="let user">{{ user.user_data[0].value_key }}</td>
        </ng-container>
        <ng-container matColumnDef="Codigo">
            <th mat-header-cell *matHeaderCellDef>Código</th>
            <td mat-cell *matCellDef="let user">{{ user.user_data[0].value_key }}</td>
        </ng-container>
        <tr mat-header-row *matHeaderRowDef="columns"></tr>
        <tr mat-row *matRowDef="let myRowData; columns: columns"></tr>
        <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell" colspan="4">No se encuentra el dato filtrado "{{ input.value }}"</td>
        </tr>

    </table>
    <mat-paginator [pageSizeOptions]="[5, 10, 20]" showFirstLastButtons></mat-paginator>
    </mat-sidenav-content>
  </mat-sidenav-container>