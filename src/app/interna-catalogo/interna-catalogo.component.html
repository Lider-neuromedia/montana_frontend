<app-header breadcrumbs="Catálogos / Productos"></app-header>

<app-dialog-pedido [id_catalogo]="id_catalogo" [id_producto]="id_producto"></app-dialog-pedido>

<div class="workplace">
    <div class="slide-menu">
        <app-menu></app-menu>
    </div>
    <div class="area">
        <!-- <router-outlet></router-outlet> -->
        <div class="row">
            <div class="filtros filtro-producto">
                <div class="filtro-ordernar">
                    <mat-form-field>
                    <mat-label>Ordenar por:</mat-label>
                    <mat-select>
                        <mat-option (click)="ordenarFiltro('mayor_menor')" value="mayor_menor">
                            De mayor a menor
                        </mat-option>
                        <mat-option (click)="ordenarFiltro('menor_mayor')"  value="menor_mayor">
                            De menor a mayor
                        </mat-option>
                        <mat-option (click)="ordenarFiltro('stock')"  value="stock">
                            stock
                        </mat-option>
                    </mat-select>
                    </mat-form-field>
                </div>
                <div class="box-buscador buscador-producto">
                    <img class="lupa" src="./assets/img/search.svg" alt="">
                    <input class="buscador mr-1" placeholder="Buscar" (keyup)="filtro($event)" type="text" #input>
                </div>
                <div class="box-create-new create-new">
                    <div class="box-mas">
                        <img class="mas" src="./assets/img/mas.svg" alt="">
                    </div>
                    <a class="btn-nuevo-cliente" (click)="openDrawerRigth(true, 'create')">Nuevo Producto</a>
                </div>
            </div>
        </div>

        <app-drawer-rigth name="create-producto" title="Nuevo producto" [open]="openDrawer"
        (close)="openDrawerRigth(false, 'create')" (submit)="submitCreateProduct(form)">
            <form #form="ngForm">
                <div class="label-field">
                    <label for="">Nombres</label>
                    <input [(ngModel)]="crearProducto.nombre" name="nombre" type="text" class="" required>
                    <small *ngIf="nombreBool"><span class="text-danger">{{error.nombre}}</span></small>
                </div>
                <div class="label-field">
                    <label for="">Código</label>
                    <input [(ngModel)]="crearProducto.codigo" name="codigo" type="text" class="" required>
                    <small *ngIf="codigoBool"><span class="text-danger">{{error.codigo}}</span></small>
                </div>
                <div class="label-field">
                    <label for="">Referencia</label>
                    <input [(ngModel)]="crearProducto.referencia" name="referencia" type="text" class="" required>
                    <small *ngIf="referenciaBool"><span class="text-danger">{{error.referencia}}</span></small>
                </div>
                <div class="label-field">
                    <label for="">Stock</label>
                    <input [(ngModel)]="crearProducto.stock" name="stock" type="number" class="" required>
                    <small *ngIf="stockBool"><span class="text-danger">{{error.stock}}</span></small>
                </div>
                <div class="label-field">
                    <label for="">Marca</label>
                    <select [(ngModel)]="crearProducto.marca" name="marca" type="text" class="" required>
                        <option>Seleccione...</option>
                        <option *ngFor="let marca of marcas" [value]="marca.id_marca"> {{marca.nombre_marca}}</option>
                    </select>
                    <small *ngIf="marcarBool"><span class="text-danger">{{error.marca}}</span></small>
                </div>
                <div class="label-field">
                    <label for="">Precio</label>
                    <input [(ngModel)]="crearProducto.precio" name="precio" type="number" class="" required>
                    <small *ngIf="precioBool"><span class="text-danger">{{error.precio}}</span></small>
                </div>
                <div class="label-field">
                    <label for="">Descripción</label>
                    <editor [(ngModel)]="crearProducto.descripcion"
                    name="descripcion"
                    apiKey="kj0s5hcgbtivft47uma4vhezznlb62r2gg0sqp7rcpqx6vzr"
                    [init]="{height: 500,
                        menubar: false,
                        plugins: [
                          'advlist autolink lists link image charmap print',
                          'preview anchor searchreplace visualblocks code',
                          'fullscreen insertdatetime media table paste',
                          'help wordcount'
                        ],
                        toolbar:
                          'undo redo | formatselect | bold italic | \
                          alignleft aligncenter alignright alignjustify | \
                          bullist numlist outdent indent | help'}"
                    ></editor>
                    <!-- <textarea [(ngModel)]="crearProducto.descripcion" name="descripcion" class="text-area" required>
                    </textarea> -->
                    <small *ngIf="descripcionBool"><span class="text-danger">{{error.descripcion}}</span></small>
                </div>

                <div class="label-field" style="display: flex;">
                    <div class="col-md-6">   
                        <label for="">Imagen destacada</label>
                        <div class="custom-dropzone" ngx-dropzone [accept]="'image/*'" [multiple]="false"
                            (change)="onSelect($event, false, 'files_1')">
                            <ngx-dropzone-label>
                                <div>
                                    <mat-icon aria-hidden="false" aria-label="Camera icon" style="font-size: 50px;position: relative;right: .8rem;">photo_camera</mat-icon>
                                    <h6>Suelta los archivos aquí o haz clic para subirlos...</h6>
                                </div>
                            </ngx-dropzone-label>
                            <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview" *ngFor="let f of files_1"
                                [file]="f" [removable]="true" (removed)="onRemove(f, 'files_1')">
                                <ngx-dropzone-label>({{ f.type }})</ngx-dropzone-label>
                            </ngx-dropzone-image-preview>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <label for="">Imagen destacada</label>
                        <div class="custom-dropzone" ngx-dropzone [accept]="'image/*'" [multiple]="false"
                            (change)="onSelect($event, false, 'files_2')">
                            <ngx-dropzone-label>
                                <div>
                                    <mat-icon aria-hidden="false" aria-label="Camera icon" style="font-size: 50px;position: relative;right: .8rem;">photo_camera</mat-icon>
                                    <h6>Suelta los archivos aquí o haz clic para subirlos...</h6>
                                </div>
                            </ngx-dropzone-label>
                            <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview" *ngFor="let f of files_2"
                                [file]="f" [removable]="true" (removed)="onRemove(f, 'files_2')">
                                <ngx-dropzone-label>({{ f.type }})</ngx-dropzone-label>
                            </ngx-dropzone-image-preview>
                        </div>
                    </div>
                </div>

                <div class="label-field" style="display: flex;">
                    <div class="col-md-6">
                        <div class="custom-dropzone" ngx-dropzone [accept]="'image/*'" [multiple]="false"
                            (change)="onSelect($event, false, 'files_3')">
                            <ngx-dropzone-label>
                                <div>
                                    <mat-icon aria-hidden="false" aria-label="Camera icon" style="font-size: 50px;position: relative;right: .8rem;">photo_camera</mat-icon>
                                    <h6>Suelta los archivos aquí o haz clic para subirlos...</h6>
                                </div>
                            </ngx-dropzone-label>
                            <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview" *ngFor="let f of files_3"
                                [file]="f" [removable]="true" (removed)="onRemove(f, 'files_3')">
                                <ngx-dropzone-label>({{ f.type }})</ngx-dropzone-label>
                            </ngx-dropzone-image-preview>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="custom-dropzone" ngx-dropzone [accept]="'image/*'" [multiple]="false"
                            (change)="onSelect($event, false, 'files_4')">
                            <ngx-dropzone-label>
                                <div>
                                    <mat-icon aria-hidden="false" aria-label="Camera icon" style="font-size: 50px;position: relative;right: .8rem;">photo_camera</mat-icon>
                                    <h6>Suelta los archivos aquí o haz clic para subirlos...</h6>
                                </div>
                            </ngx-dropzone-label>
                            <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview" *ngFor="let f of files_4"
                                [file]="f" [removable]="true" (removed)="onRemove(f, 'files_4')">
                                <ngx-dropzone-label>({{ f.type }})</ngx-dropzone-label>
                            </ngx-dropzone-image-preview>
                        </div>
                    </div>
                </div>

                <div class="label-field" style="display: flex;">
                    <div class="col-md-6">
                        <div class="custom-dropzone" ngx-dropzone [accept]="'image/*'" [multiple]="false"
                            (change)="onSelect($event, false, 'files_5')">
                            <ngx-dropzone-label>
                                <div>
                                    <mat-icon aria-hidden="false" aria-label="Camera icon" style="font-size: 50px;position: relative;right: .8rem;">photo_camera</mat-icon>
                                    <h6>Suelta los archivos aquí o haz clic para subirlos...</h6>
                                </div>
                            </ngx-dropzone-label>
                            <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview" *ngFor="let f of files_5"
                                [file]="f" [removable]="true" (removed)="onRemove(f, 'files_5')">
                                <ngx-dropzone-label>({{ f.type }})</ngx-dropzone-label>
                            </ngx-dropzone-image-preview>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="custom-dropzone" ngx-dropzone [accept]="'image/*'" [multiple]="false"
                            (change)="onSelect($event, false, 'files_6')">
                            <ngx-dropzone-label>
                                <div>
                                    <mat-icon aria-hidden="false" aria-label="Camera icon" style="font-size: 50px;position: relative;right: .8rem;">photo_camera</mat-icon>
                                    <h6>Suelta los archivos aquí o haz clic para subirlos...</h6>
                                </div>
                            </ngx-dropzone-label>
                            <ngx-dropzone-image-preview ngProjectAs="ngx-dropzone-preview" *ngFor="let f of files_6"
                                [file]="f" [removable]="true" (removed)="onRemove(f, 'files_6')">
                                <ngx-dropzone-label>({{ f.type }})</ngx-dropzone-label>
                            </ngx-dropzone-image-preview>
                        </div>
                    </div>
                </div>
            </form>
        </app-drawer-rigth>
        <div>
            <table mat-table [dataSource]="dataSource">
                <ng-container matColumnDef="productos">
                    <th *matHeaderCellDef></th>
                    <td *matCellDef="let producto">
                        <div class="row">
                            <div class="col-md-12">
                                <div class="row row-producto" style="border-radius: 6px;">
                                    <div class="col-md-4">
                                        <img src="{{producto.image}}" alt="{{producto.nombre}}">
                                    </div>
                                    <div class="col-md-4 border-rh-lft" style="display: flex; align-items: center;">
                                        <div class="info-interna">
                                            <p class="codigo">Cod: {{producto.codigo}}</p>
                                            <p class="referencia">Ref: {{producto.referencia}}</p>
                                            <p class="marca">{{producto.nombre_marca}}</p>
                                            <p class="nombre">{{producto.nombre}}</p>
                                            <p class="stock">Stock: {{producto.stock}} pares</p>
                                            <p class="precio">{{producto.total |currency:'COP':'symbol-narrow' :'1.0-0'}}</p>
                                        </div>
                                    </div>
                                    <div class="col-md-4 end-content">
                                        <a (click)="verProducto(producto.id_producto)" class="ver-producto">
                                            Ver producto
                                        <div class="box-ver">
                                            <img src="./assets/img/ojo.svg" class="iconos-ojo" alt="">
                                        </div>
                                        </a>
                                        <a class="anadir-a-pedido" (click)="openDialogPedido(producto.id_producto)">
                                            Añadir a pedido
                                            <div class="box-add">
                                                <img class="iconos-bolsa" width="100" src="./assets/img/bolsa.svg" alt="">
                                            </div>
                                            
                                        </a>
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12 no-products" *ngIf="productos.length == 0">
                                <p>
                                    <mat-icon style="font-size: 70px;">sentiment_dissatisfied</mat-icon>
                                </p>
                                <h2>No has registrado productos aun...</h2>
                            </div>
                        </div>
                    </td>
                    <tr mat-header-row *matHeaderRowDef="columns"></tr>
                    <tr mat-row *matRowDef="let row; columns: columns"></tr>
                    <tr class="mat-row" *matNoDataRow>
                        <td class="mat-cell" colspan="4">
                            <div class="col-md-12 text-center no-catalogo">
                                <div class="sin-catalogo">
                                    <img src="./assets/img/sin_novedad.png" alt="">
                                    <p>Aún no se registran Productos</p>
                                </div>
                            </div>
                        </td>
                      </tr>
                </ng-container>
            </table>
            <mat-paginator [pageSizeOptions]="[2, 5, 10, 20]" showFirstLastButtons></mat-paginator>
        </div>
    </div>
</div>